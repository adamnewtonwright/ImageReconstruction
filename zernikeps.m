function [ Theta ] = zernikeps( c, r, theta, one )
% Calculates the zernike polynomials
%   c is a vector of coefficents, denoting which polynomial will be present and how much influence
%   it will have.
%   x = linspace(-2,2-4/128,128); [X,Y] = meshgrid(x,x);
%   [theta,r] = cart2pol(X,Y);
%   one = ones(size(r));


Theta = c(1).*one+...
    c(2).*(2.*r.*cos(theta))+ c(3).*(2.*r.*sin(theta))+ c(4).*sqrt(3).*(-one + 2.*r.^2)+...
    c(5).*sqrt(6).*(r.^2.*sin(2.*theta))+ c(6).*sqrt(6).*(r.^2.*cos(2.*theta))+ c(7).*sqrt(8).*(3.*r.^3-2.*r).*sin(theta)+...
    c(8).*sqrt(8).*(3.*r.^3-2.*r).*cos(theta)+ c(9).*sqrt(8).*r.^3.*sin(3.*theta)+ c(10).*sqrt(8).*r.^3.*cos(3.*theta);%+...
%     c(11).*(r.^3.*sin(3.*theta))+ c(12).*(r.^2.*(-3.*one+4.*r.^2).*cos(2.*theta))+ c(13).*(r.^2.*(-3.*one+4.*r.^2).*sin(2.*theta))+...
%     c(14).*(r.*(3.*one-12.*r.^2+10.*r.^4).*cos(theta))+ c(15).*(r.*(3.*one-12.*r.^2+10.*r.^4).*sin(theta))+ c(16).*(-one+12.*r.^2-30.*r.^4+20.*r.^6)+...
%     c(17).*(r.^4.*cos(2.*theta))+ c(18).*(r.^4.*sin(2.*theta))+ c(19).*(r.^3.*(-4.*one+5.*r.^2).*cos(3.*theta))+...
%     c(20).*(r.^3.*(-4.*one+5.*r.^2).*sin(3.*theta))+ c(21).*(r.^2.*(6.*one-20.*r.^2+15.*r.^4).*cos(2.*theta))+ c(22).*(r.^2.*(6.*one-20.*r.^2+15.*r.^4).*sin(2.*theta));

end

